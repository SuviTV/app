<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta
    http-equiv='X-UA-Compatible'
    content='IE=edge,chrome=1'
  >
  <title>Suvi Social Streaming</title>
  <meta
    name='viewport'
    content='width=device-width, initial-scale=1.0'
  />
  <link
    href='https://fonts.googleapis.com/css?family=Nunito:200'
    rel='stylesheet'
  >
  <link
    rel='shortcut icon'
    type='image/png'
    href='https://s3.amazonaws.com/suvi-assets/Suvi+App+Icon+(Circle).png'
  >

</head>
<style>
  body, html {
      font: 'Nunito';
      height: 100%;
      background-color: #f9f9f9;
      margin: 0;
    }
    
  body {
      background-image: url('https://s3.amazonaws.com/suvi-assets/Abstract+Colors.png');
      background-size: cover;
      background-position: center bottom;
      display: flex;
      justify-content: center;
    }

    input {
      background: #fdfdfd;
      padding: 0.5rem 1.5rem 0.5rem 1.5rem;
      margin: 1rem 0;
      font-family: 'Nunito';
      font-size: 2rem;
      border-radius: 75px;
      border: none;
    }

    input:focus {
      outline: none;
    }

    button {
      display: inline-block;
      border: none;
      border-radius: 75px;
      padding: 1.3rem 5rem;
      margin: 1rem 0;
      position: relative;
      text-decoration: none;
      background: none;
      /* color: #ffffff; */
      font-family: 'Nunito';
      font-size: 1.4rem;
      cursor: pointer;
      text-align: center;
      transition: background 250ms ease-in-out, 
                  transform 150ms ease;
      -webkit-appearance: none;
      -moz-appearance: none;
    }

    button:hover,
    button:focus {
        background: #0053ba;
    }

    button:focus {
        outline: none;
    }

    button:active {
        transform: scale(0.99);
    }

    label {
      font-family: 'Nunito';
    }

    .App {
      height: 100%;
      width: 100vw;
      display: flex;
      align-items: center;
      justify-content: space-around;
    }

    .App-header {
      height: 60px;
      width: 100%;
      background: rgba(255, 255, 255, 0.7);
      position: fixed;
      top: 0;
    }

    .iPhoneRender {
      display: flex;
      height: 600px;
      margin-top: 60px;
    }
    .suviLogoFull {
      height: 50px;
    }

    .login-container {
      height: calc(100% - 60px);
      margin-top: 60px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .login-box {
      display: flex;
      flex-direction: column;
    }

    .login-header {
      font-family: 'Nunito';
      font-size: 2rem;
      text-align: center;
      padding-bottom: 25px;
    }

    .login-form {
      display: flex;
      flex-direction: column;
      padding-top: 1rem;
    }

    #divider {
      height: 1px;
      border-top: 1px solid rgba(150, 150, 150, .7);
    }

    #btn-login {
      background: linear-gradient(
        224deg,
        #00bc29 0%,
        #0692bb 67%,
        #0b73bf 100%
      );
      color: #ffffff;
    }

    #btn-facebook {
      background: #1846a7;
      color: #ffffff; 
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 0.4rem;
      padding-bottom: 0.4rem;
      text-align: center;
    }

    #btn-facebook > img {
      position: relative;
      right: 73px;
      height: 2.7em;
      margin-right: calc(-73px / 2);
    }

    #btn-create {
      background: #f62a1e;
      color: #ffffff;
    }
  </style>

<body>
  <div id='root'></div>
  <!--[if IE 8]>
  <script src='//cdnjs.cloudflare.com/ajax/libs/ie8/0.2.5/ie8.js'></script>
  <![endif]-->

  <!--[if lte IE 9]>
  <script src='https://cdn.auth0.com/js/polyfills/1.0/base64.min.js'></script>
  <script src='https://cdn.auth0.com/js/polyfills/1.0/es5-shim.min.js'></script>
  <![endif]-->

  <script src='https://cdn.auth0.com/js/auth0/9.2/auth0.min.js'>
  </script>
  <script src='https://cdn.auth0.com/js/polyfills/1.0/object-assign.min.js'>
  </script>
  <script
    crossorigin
    src='https://unpkg.com/react@16/umd/react.development.js'
  ></script>
  <script src='https://unpkg.com/babel-standalone@6/babel.min.js'>
  </script>
  <script
    crossorigin
    src='https://unpkg.com/react-dom@16/umd/react-dom.production.min.js'
  >
  </script>
  <script type='text/babel'>
    const config = JSON.parse(
      decodeURIComponent(escape(window.atob('@@config@@')))
    );

    const params = Object.assign({
      overrides: {
        __tenant: config.auth0Tenant,
        __token_issuer: 'login.suvi.tv'
      },
      domain: config.auth0Domain,
      clientID: config.clientID,
      redirectUri: config.callbackURL,
      responseType: 'code'
    }, config.internalOptions);

    const webAuth = new auth0.WebAuth(params);

    const databaseConnection = 'Username-Password-Authentication';


    /**
    @type _App_initialState: {
      modal: '' | 'create' | 'login'
    }
    */
    const _App_initialState = {
      email: '',
      password: ''
    };
    const suviLogoFull = 'https://s3.amazonaws.com/suvi-assets/Suvi+Logo.png';
    const iPhoneRender = 'https://s3.amazonaws.com/suvi-assets/Home+Screen+(iPhone+X).png';
    const fbookIconWhite = 'https://s3.amazonaws.com/suvi-assets/Facebook+Icon+(White).png'; 
    
    class App extends React.Component {
      state = _App_initialState

      setCreateFlag = () => {
        const { create } = this.state;

        this.setState({ create: !create });
      }

      handleSubmit = (type) => {
        const submit = (
          this.state.create ?
            this.signup :
            this.login
        );

        submit({...this.state});
      }

      signup = () => {
        webAuth.redirect.signupAndLogin({
          connection: databaseConnection,
          email,
          password
        }, function (err) {
          if (err) displayError(err);
        });
      }

      login = () => {
        webAuth.login({
          realm: databaseConnection,
          email,
          password
        }, function (err) {
          if (err) throw err;
        });
      }

      handleInputChange = (e) => {
        e.preventDefault();

        const {
          name,
          value
        } = e.target

        this.setState({
          [name]: value
        });
      }

      loginWithFacebook = () => {
        webAuth.authorize({
          connection: 'facebook'
        }, function (err) {
          if (err) throw err;
        });
      }

      render = () => {
        return (
          <main className='App'>
            <header className='App-header'>
              <img 
                className='suviLogoFull'
                src={suviLogoFull}
              />
            </header>
            <img
              className='iPhoneRender'
              src={iPhoneRender}
            />
            <div className='login-container'>
              <div className='login-box'>
                <header className='login-header'>
                  Welcome to Suvi
                </header>
                {!this.state.create && (
                  <button
                    onClick={this.loginWithFacebook}
                    id='btn-facebook'
                  >
                    <img src={fbookIconWhite}/>
                    Login with Facebook
                  </button>
                )}
                <button
                  id='btn-create'
                  name='create'
                  onClick={this.setCreateFlag}
                >
                  {this.state.create ? 'Cancel' : 'Create account'}  
                </button>
                
                <div id='divider'></div>

                <form 
                  onSubmit={this.handleSubmit}
                  className='login-form'
                 >
                  <label for='email'>Email</label>
                  <input
                    name='email'
                    onChange={this.handleInputChange}
                    value={this.state.email}
                  />
                  {/* this.state.create && (
                    <React.Fragment>
                      <label for='name'>Name</label>
                      <input
                        name='name'
                        onChange={this.handleInputChange}
                        value={this.state.name}
                      />
                    </React.Fragment>
                  )*/}
                  <label for='password'>Password</label>
                  <input
                    name='password'
                    type='password'
                    onChange={this.handleInputChange}
                    value={this.state.password}
                  />
                  <button
                    type='submit'
                    id='btn-login'
                    name='login'
                  >
                    Login
                  </button>
                </form>
              </div>
            </div>
          </main>
        );
      }
    }

    ReactDOM.render(
      <App />,
      document.getElementById('root')
    );
  </script>
</body>

</html>